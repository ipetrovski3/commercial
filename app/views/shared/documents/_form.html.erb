<div data-controller="math" data-math-controller-value="<%= attribute %>">
<%= form_for document, data: { turbo: false } do |f| %>
  
  <div class="space-y-3 sm:space-y-0 sm:flex sm:items-center sm:space-x-2">
    <%= f.label :date, class:'sr-only' %>
    <%= f.date_field :date, class:'block border border-gray-200 rounded px-3 py-2 leading-6 w-56 focus:border-blue-500 focus:ring focus:ring-blue-500 focus:ring-opacity-50', data: { math_target: 'dateToday' } %>
    <%= f.label :number, value: @number, class:'sr-only' %>
    <%= f.text_field :number, placeholder: 'Број на фактура', class:'block border border-gray-200 rounded px-3 py-2 leading-6 w-32 focus:border-blue-500 focus:ring focus:ring-blue-500 focus:ring-opacity-50' %>
    <%= f.label :customer, class:'sr-only' %>
    <div class="w-96" data-controller="autocomplete" data-autocomplete-url-value="<%= invoiced_customers_path %>" role="combobox">
      <input type="text" id="customer_input" placeholder="Клиент" class="block border border-gray-200 w-full rounded px-3 py-2 leading-6 focus:border-blue-500 focus:ring focus:ring-blue-500 focus:ring-opacity-50" data-autocomplete-target="input"/>
        <%= f.hidden_field :customer_id,  data: { autocomplete_target: 'hidden', math_target: 'customer', action: 'change->math#set_customer_due_days' } %>
      <ul class="list-group overflow-y-scroll max-h-64 w-1/4 fixed bg-white z-0" data-autocomplete-target="results"></ul>
    </div>
  </div>
  <% if controller_name == 'invoices' %>
    <div class="mt-3 space-y-3 sm:space-y-0 sm:flex sm:items-center sm:space-x-2">
      <%= f.label :received_by, class:'sr-only' %>
      <%= f.text_field :received_by, placeholder: 'Примил Име и Презиме', class:'block border border-gray-200 rounded px-3 py-2 leading-6 w-56 focus:border-blue-500 focus:ring focus:ring-blue-500 focus:ring-opacity-50' %>
      <%= f.label :licence_plate, value: @number, class:'sr-only' %>
      <%= f.text_field :licence_plate, placeholder: 'Рег број на возило', class:'block border border-gray-200 rounded px-3 py-2 leading-6 w-56 focus:border-blue-500 focus:ring focus:ring-blue-500 focus:ring-opacity-50' %>
    </div>
  <% end %>
  <% unless controller_name == 'incoming_invoices' %>
    <div class="mt-3 space-y-3 sm:space-y-0 sm:flex sm:items-center sm:space-x-2">
      <%= f.label 'Валута', class:'' %>
      <%= f.number_field :due_days, placeholder: 'Примил Име и Презиме', class:'block border border-gray-200 rounded px-3 py-2 leading-6 w-16 focus:border-blue-500 focus:ring focus:ring-blue-500 focus:ring-opacity-50' %>
    </div>
  <% end %>
  
  <div class="mt-16 grid grid-cols-3 gap-2">
    <div class="shadow overflow-y-scroll h-96 col-span-2">
      <%= render 'shared/documents/nested', f: f %>
    </div>
    <div>
    <% unless @issue_slip %>
      
      <div class="mt-36 border-y p-3 border-gray-400 mb-4 flex justify-between">
        <div class="text-gray-700 font-semibold text-sm tracking-wider uppercase text-left">
          ДДВ
        </div>
        <div class="text-gray-700 font-semibold text-sm tracking-wider uppercase text-right">
          18%
        </div>
      </div>
      <div class="border-y p-3 border-gray-400 mb-4 flex justify-between">
        <div class="text-gray-700 font-semibold text-sm tracking-wider uppercase text-left">
          Износ без ДДВ
        </div>
        <div data-math-target="withOutDDV" class="text-gray-700 font-semibold text-sm tracking-wider uppercase text-right">
          <%= document.net_price.present? ? number_to_currency(document.net_price, locale: :mk) : '/' %>
        </div>
      </div>
      <div class="border-y p-3 border-gray-400 mb-4 flex justify-between">
        <div class="text-gray-700 font-semibold text-sm tracking-wider uppercase text-left">
          ДДВ Износ
        </div>
        <div data-math-target="ddv" class="text-gray-700 font-semibold text-sm tracking-wider uppercase text-right">
          <%= document.vat.present? ? number_to_currency(document.vat, locale: :mk) : '/' %>
        </div>
      </div>
      <div class="border-y p-3 border-gray-400 mb-4 flex justify-between">
        <div class="text-gray-700 font-semibold text-sm tracking-wider uppercase text-left">
          Вкупен износ:
        </div>
        <div data-math-target="netPrice" class="text-gray-700 font-semibold text-sm tracking-wider uppercase text-right">
        <%= document.total_price.present? ? number_to_currency(document.total_price, locale: :mk) : '/' %>
        </div>
      </div>
    
    <% end %>
    </div>
  </div>

  <%= f.submit "Create Invoice", class: "mt-4 bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded" %>
<% end %>
</div>



